
\chapter{Ugeopgave 5-7}

Denne ugeopgaves formål var at implementere og forstå
\emph{radiosity}-metoden.

\paragraph{Bemærk}
\label{sec:bemark}

Dele af den eksekverbare fil (del 5 og 6) til denne opgave virker ikke
på de gamle maskiner i VR-baren. De virker dog på de nye. Vi har ikke
kunnet finde grunden til det.

\section{Del 1}
\label{sec:ex5-1}

Første opgave er at downloade kildekoden og køre den. Det skulle
vise Cornell-scenen uden radiosity. Resultatet kan ses på figur
\ref{figur-5-1-1}.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=8cm]{screenshots/ex5/1.png}
  \caption{Cornell-scenen uden radiosity} 
  \label{figur-5-1-1}
\end{figure}

\section{Del 2}
\label{sec:ex5-2}

Dernæst skal scenen \textit{meshes}. På figur \ref{figur-5-2-1} kan vi
se scenen delt op i mindre stykker med brug af mesher-biblioteket.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=8cm]{screenshots/ex5/2.png}
  \caption{Den meshede Cornell-scene}
  \label{figur-5-2-1}
\end{figure}

\section{Del 3}
\label{sec:ex5-3}

I tredje del af opgaven skal vi lave \textit{progressive refinement}. Det
kræver at vi implementerer følgende funktioner som skal bruger i hver
iteration af main loopet:

\begin{itemize}
\item En funktion der finder den \textit{patch} med størst energi.
\item En funktion der udregner \textit{form factors} mellem en
  \textit{patch} og alle de andre \textit{patches}. Dette gøres
  analytisk.
\item En funktion der distribuerer energi fra en \textit{patch} til
  alle andre \textit{patches}
\item En funktion der beregner farven af alle \textit{patches}.
\end{itemize}

Resultatet kan ses på figur \ref{figur-5-3-1}. Billedet viser tydeligt
firkanter, men dette bliver bedre når vi har lavet delopgave fire.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=8cm]{screenshots/ex5/3.png}
  \caption{Lys i den meshede scene}
  \label{figur-5-3-1}
\end{figure}

\section{Del 4}
\label{sec:ex5-4}

Som nævn tidligere skal opgave 4 arbejde på at gøre billedets
farveskift glattere. Vi implementerer derfor \textit{vertex radiosity}
som kaldes \textit{nodal-averages}. Resultatet kan ses på figur
\ref{figur-5-4-1}


\begin{figure}[htbp]
  \centering
  \includegraphics[width=8cm]{screenshots/ex5/4.png}
  \caption{Nodal averages}
  \label{figur-5-4-1}
\end{figure}

\section{Del 5}
\label{sec:ex5-5}

Nu vil vi gerne bruge \texttt{hemicube} metoden istedet for at beregne
\textit{form factors} annalytisk. Derfor anvender vi
\texttt{hemicube.h}. Nu har billedet fået skygger, modsat
tidligere. Da vi hele tiden har anvendt scenen med kasserne i skifter
vi ikke scene, men det er tydeligt at se forskellen.

I figur \ref{figur-5-5-1} og \ref{figur-5-5-2} ser vi scenen med
skygger med og uden \textit{nodal-averaging}.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=8cm]{screenshots/ex5/5a.png}
  \caption{Hemicube}
  \label{figur-5-5-1}
\end{figure}

\begin{figure}[htbp]
  \centering
  \includegraphics[width=8cm]{screenshots/ex5/5b.png}
  \caption{Hemicube med nodal averages}
  \label{figur-5-5-2}
\end{figure}

\section{Del 6}
\label{sec:ex5-6}

\paragraph{What is the effect of changing the subdivision level of the
  light source?}

Et lavt niveau vil resultere i \textit{patches} får meget
\textit{unshot radiosity} som langsomt konvergerer mod nul og derfor
forøjer tiden det tager at rendere. Der vil også opstå
\textit{aliasing} problemer omkring lyskilden og kanten af
skyggerne. Et for højt niveau ødelægger farve \textit{bleeding} og
noget af skyggerne.

\paragraph{What happens when the size of the hemicube is changed? Why
  does it happen? What can be done to avoid this problem?}

I figur \ref{figur-5-6-1} og \ref{figur-5-6-2} kan vi se hvad der sker
når \textit{hemicuben} er hhv. ekstremt stor og ekstremt lille.

Der opstår fejl fordi der antages at \textit{patches} projicerer
præcist over på et heltal pixels. Dette er sjældent tilfældet.

Man kan sætte opløsningen af hemicuben op, men det betyder også at der
skal regnes langt mere.

\begin{figure}[htbp]
  \centering
  \includegraphics[width=8cm]{screenshots/ex5/6b1.png}
  \caption{For stor hemicube}
  \label{figur-5-6-1}
\end{figure}
\begin{figure}[htbp]
  \centering
  \includegraphics[width=8cm]{screenshots/ex5/6b2.png}
  \caption{For lille hemicube}
  \label{figur-5-6-2}
\end{figure}

\paragraph{What effect can be captured using radiosity, that can not be
  captured using ray tracing?}

\textit{Radiosity} kan vise diffuse \textit{interreflections}, som
bla. kan ses ved farvernes \textit{bleed}, i modsætning til ray
tracing. \textit{Radiosity} kan håndtere \texttt{LD*E} mens rekursiv
\textit{raytracing} samt lokal belysning kan klare \texttt{LD?S*E}.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "report_main"
%%% End: 
